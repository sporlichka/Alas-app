<main class="py-8 m-3 sm:py-12 min-h-[50vh]">
  <section class="mx-auto max-w-screen-xl px-4 sm:px-6 lg:px-8">
    <header>
      <h2 class="text-xl font-bold text-gray-900 sm:text-3xl">Products</h2>
      <p class="mt-4 max-w-md text-gray-500">
        Discover the latest in footwear fashion and find your perfect pair of
        sneakers. Whether you're looking for the hottest brands or classic
        styles, we have something for every taste. Explore our collection and
        step up your shoe game today!
      </p>
    </header>

    <div class="mt-8 lg:grid lg:grid-cols-4 lg:gap-8">
      <button
        type="button"
        class="lg:hidden flex items-center justify-between px-3 py-1 bg-black text-white rounded shadow-md hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-gray-500 transition-all duration-300 mb-4"
        (click)="toggleFilters()"
      >
        <span class="text-xs font-medium">Filters</span>
        <svg
          xmlns="http://www.w3.org/2000/svg"
          fill="none"
          viewBox="0 0 24 24"
          stroke-width="1.5"
          stroke="currentColor"
          class="h-5 w-5"
        >
          <path
            stroke-linecap="round"
            stroke-linejoin="round"
            d="M6 9l6 6 6-6"
          />
        </svg>
      </button>

      <div
        [ngClass]="{ hidden: !isFiltersVisible, 'lg:block': true }"
        class="lg:col-span-1 space-y-4 mt-4 lg:mt-0"
      >
        <details
          class="overflow-hidden rounded border border-gray-300 [&_summary::-webkit-details-marker]:hidden"
        >
          <summary
            class="flex cursor-pointer items-center justify-between gap-2 p-4 text-gray-900 transition"
          >
            <span class="text-sm font-medium">Availability</span>
            <span class="transition group-open:-rotate-180">
              <svg
                xmlns="http://www.w3.org/2000/svg"
                fill="none"
                viewBox="0 0 24 24"
                stroke-width="1.5"
                stroke="currentColor"
                class="h-4 w-4"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  d="M19.5 8.25l-7.5 7.5-7.5-7.5"
                />
              </svg>
            </span>
          </summary>
          <div class="border-t border-gray-200 bg-white">
            <ul class="space-y-1 border-t border-gray-200 p-4">
              <li>
                <label
                  for="FilterInStock"
                  class="inline-flex items-center gap-2"
                >
                  <input
                    type="radio"
                    id="FilterInStock"
                    name="stock"
                    class="size-5 rounded border-gray-300 accent-black"
                    [(ngModel)]="filters.has_stock"
                    [value]="true"
                    (ngModelChange)="ApplyFilters()"
                  />
                  <span class="text-sm font-medium text-gray-700"
                    >In Stock</span
                  >
                </label>
              </li>
              <li>
                <label
                  for="FilterOutOfStock"
                  class="inline-flex items-center gap-2"
                >
                  <input
                    type="radio"
                    id="FilterOutOfStock"
                    name="stock"
                    class="size-5 rounded border-gray-300 accent-black"
                    [(ngModel)]="filters.has_stock"
                    [value]="false"
                    (ngModelChange)="ApplyFilters()"
                  />
                  <span class="text-sm font-medium text-gray-700"
                    >Out of Stock</span
                  >
                </label>
              </li>
            </ul>
          </div>
        </details>

        <details
          class="overflow-hidden rounded border border-gray-300 [&_summary::-webkit-details-marker]:hidden"
        >
          <summary
            class="flex cursor-pointer items-center justify-between gap-2 p-4 text-gray-900 transition"
          >
            <span class="text-sm font-medium">Price</span>
            <span class="transition group-open:-rotate-180">
              <svg
                xmlns="http://www.w3.org/2000/svg"
                fill="none"
                viewBox="0 0 24 24"
                stroke-width="1.5"
                stroke="currentColor"
                class="h-4 w-4"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  d="M19.5 8.25l-7.5 7.5-7.5-7.5"
                />
              </svg>
            </span>
          </summary>
          <div class="border-t border-gray-200 bg-white">
            <div class="border-t border-gray-200 p-4">
              <div class="flex justify-between gap-4">
                <label for="FilterPriceFrom" class="flex items-center gap-2">
                  <span class="text-sm text-gray-600">$</span>
                  <input
                    type="number"
                    id="FilterPriceFrom"
                    placeholder="From"
                    class="w-full rounded-md border-gray-200 shadow-sm sm:text-sm"
                    [(ngModel)]="filters.min_price"
                  />
                </label>
                <label for="FilterPriceTo" class="flex items-center gap-2">
                  <span class="text-sm text-gray-600">$</span>
                  <input
                    type="number"
                    id="FilterPriceTo"
                    placeholder="To"
                    class="w-full rounded-md border-gray-200 shadow-sm sm:text-sm"
                    [(ngModel)]="filters.max_price"
                  />
                </label>
              </div>
            </div>
            <div class="flex items-center justify-between p-4">
              <button
                type="button"
                class="text-sm text-gray-900 underline underline-offset-4"
                (click)="ApplyFilters()"
              >
                Apply Filters
              </button>
            </div>
          </div>
        </details>

        <details
          class="overflow-hidden rounded border border-gray-300 [&_summary::-webkit-details-marker]:hidden"
        >
          <summary
            class="flex cursor-pointer items-center justify-between gap-2 p-4 text-gray-900 transition"
          >
            <span class="text-sm font-medium">Brands</span>
            <span class="transition group-open:-rotate-180">
              <svg
                xmlns="http://www.w3.org/2000/svg"
                fill="none"
                viewBox="0 0 24 24"
                stroke-width="1.5"
                stroke="currentColor"
                class="h-4 w-4"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  d="M19.5 8.25l-7.5 7.5-7.5-7.5"
                />
              </svg>
            </span>
          </summary>
          <div class="border-t border-gray-200 bg-white">
            <ul class="space-y-1 border-t border-gray-200 p-4">
              <li *ngFor="let brand of brands">
                <label
                  [for]="'FilterBrand' + brand.id"
                  class="inline-flex items-center gap-2 accent-black"
                >
                  <input
                    type="radio"
                    [id]="'FilterBrand' + brand.id"
                    class="size-5 rounded border-gray-300"
                    [(ngModel)]="filters.brand"
                    [value]="brand.id"
                    (ngModelChange)="ApplyFilters()"
                  />
                  <span class="text-sm font-medium text-gray-700">{{
                    brand.description
                  }}</span>
                </label>
              </li>
            </ul>
          </div>
        </details>
        <header class="flex items-center justify-between p-4">
          <button
            type="button"
            class="text-sm text-gray-900 underline underline-offset-4"
            (click)="resetFilters()"
          >
            Reset Filters
          </button>
        </header>
      </div>

      <div class="lg:col-span-3 space-y-8">
        <div class="grid grid-cols-1 gap-8 sm:grid-cols-2 lg:grid-cols-3">
          @for (product of products; track $index) {
          <div class="bg-white rounded-lg overflow-hidden shadow-lg">
            <a
              [routerLink]="'/products/' + product.id"
              class="group block overflow-hidden"
            >
              <img
                [src]="product.image"
                [alt]="product.brand?.description"
                class="w-full h-64 object-cover object-center"
            /></a>
            <div class="p-4">
              <div class="flex items-center justify-between">
                <h3 class="text-lg font-semibold text-gray-900">
                  {{ product.brand?.description }}
                </h3>
                <a
                  class="ml-3 px-3 py-1 bg-black text-white text-xs font-medium rounded hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-gray-500 transition-all duration-300"
                  [routerLink]="'/products/' + product.id"
                  >Details</a
                >
              </div>
              <h3 class="text-lg font-semibold text-gray-900">
                {{ product.model?.model }}
              </h3>
              <p class="mt-2 text-gray-700">{{ product.detail }}</p>
              <div class="mt-4 flex items-center justify-between">
                <span class="text-gray-900 font-medium"
                  >$ {{ product.price }}</span
                >
                @if (isLogged && !isAdmin){<button
                  type="button"
                  class="px-3 py-1 bg-black text-white text-xs font-medium rounded hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-gray-500 transition-all duration-300"
                  (click)="addItemCart(product.id)"
                >
                  Add to Cart</button
                >}
              </div>
            </div>
          </div>
          }
        </div>
      </div>
    </div>
  </section>
</main>
